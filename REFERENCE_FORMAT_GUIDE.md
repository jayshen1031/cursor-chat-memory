# 🎯 智能引用格式指南

## 📋 新功能亮点

### ✨ 精确来源标识系统

我们全新升级了引用格式，现在每个引用都包含**完整的来源追踪信息**，让你能够精确定位和管理历史对话。

## 🔍 引用格式详解

### 1. 标题栏 - 完整上下文信息

```
💡 **最近会话** (5个会话) | 📁 项目: cursor-chat-memory
📍 来源: /Users/jay/.cursor/chat
```

**包含信息：**
- 🎯 **模板名称**: 使用的引用模板（如"最近会话"、"问题解决"等）
- 📊 **会话数量**: 实际包含的会话数量
- 🏷️  **项目标识**: `📁 项目: [项目名]` 或 `🌐 全局记忆`
- 📍 **物理来源**: 聊天文件的实际存储路径

### 2. 会话条目 - 详细元数据

```
**1. 实现cursor-chat-memory提示词中心模块** [性能优化] 📁 PROJECT
🆔 ID: cursor-chat-memory-v2.3.0-development | ⭐ 重要性: 93%
🏷️  标签: #性能优化
📝 摘要: 项目特定的系统工程关键信息...
🕐 时间: 6/9/2025, 11:26:46 AM
```

**元数据说明：**
- **📁 PROJECT** / **🌐 GLOBAL**: 明确标识会话类型
  - `📁 PROJECT`: 与当前项目相关的会话
  - `🌐 GLOBAL`: 通用知识，适用于多个项目
- **🆔 ID**: 唯一会话标识符，便于精确引用
- **⭐ 重要性**: 0-100% 的重要性评分
- **🏷️  标签**: 自动提取的内容标签
- **🕐 时间**: 会话的最后活动时间

### 3. 底部统计 - 引用追踪

```
---
📊 引用统计: ~990 tokens | 5/5个会话
🕒 生成时间: 6/9/2025, 11:26:46 AM
🔖 引用标识: [📁 项目: cursor-chat-memory] 最近会话
```

**追踪信息：**
- **📊 Token统计**: 估算的内容长度和实际使用的会话数
- **🕒 生成时间**: 引用的创建时间
- **🔖 引用标识**: 完整的来源和模板标识

## 🎯 使用场景示例

### 场景1: 项目开发中的问题解决

当你在开发项目时遇到类似问题：

```bash
# 生成项目相关的解决方案引用
node out/cli.js get-template problem-solving
```

**输出示例：**
```
💡 **问题解决** (3个会话) | 📁 项目: my-react-app
📍 来源: /Users/jay/.cursor/chat

**1. React Component Re-render Optimization** [性能优化] 📁 PROJECT
🆔 ID: react-optimization-session | ⭐ 重要性: 95%
🏷️  标签: #React #性能 #优化
📝 摘要: 使用useMemo和useCallback减少不必要的重渲染...
🕐 时间: 6/8/2025, 3:30:00 PM

**2. Database Connection Pool Configuration** [数据库] 🌐 GLOBAL  
🆔 ID: db-pool-config | ⭐ 重要性: 88%
🏷️  标签: #数据库 #配置
📝 摘要: 连接池大小设置和超时配置最佳实践...
🕐 时间: 6/7/2025, 2:15:00 PM
```

### 场景2: 跨项目知识复用

当你需要在新项目中应用通用知识：

```bash
# 获取全局知识引用，不限定项目
node out/cli.js get-template all-important
```

### 场景3: Web界面管理

在 `http://localhost:3001` 中：

1. **历史会话管理** - 清晰区分项目会话和全局会话
2. **智能引用生成** - 实时显示来源信息
3. **分类筛选** - 按项目、类型、重要性筛选

## 💡 最佳实践

### 1. 项目标识的有效利用

- **📁 PROJECT 标签**: 快速识别项目特定的解决方案
- **🌐 GLOBAL 标签**: 确定可跨项目复用的通用知识
- **来源路径**: 验证引用的准确性和时效性

### 2. 引用管理策略

```bash
# 项目开发前：获取相关历史经验
cursor-memory project-reference recent ./my-project

# 问题解决时：搜索特定解决方案
cursor-memory search "性能优化"

# 知识积累：记录重要决策
cursor-memory record-iteration "v2.0" "重构数据层" "性能提升30%"
```

### 3. 团队协作

- **标准化引用**: 使用相同的模板和标识系统
- **知识传承**: 明确的项目标识便于知识交接
- **经验复用**: 全局标签助力跨项目经验分享

## 🔧 技术细节

### 自动分类算法

系统根据以下条件自动判断会话类型：

1. **项目相关判断**:
   - 会话内容包含项目名称
   - 标签包含项目标识
   - 文件路径相关性

2. **重要性评分**:
   - 技术深度和复杂性
   - 解决方案完整性
   - 交互频率和时长

3. **标签提取**:
   - 技术栈关键词
   - 问题类型分类
   - 解决方案模式

### API 集成

所有引用格式在以下接口中保持一致：

- `/api/sessions/reference` - 基础引用生成
- `/api/sessions/enhanced-reference` - 增强引用（含提示词）
- `/api/prompts/reference` - 提示词引用

## 🚀 升级收益

### 🎯 精确定位
- **零歧义**: 明确的项目和全局标识
- **完整追踪**: 从引用到原始对话的完整路径
- **时间标记**: 准确的时效性信息

### 🔍 智能管理
- **分类筛选**: 快速找到相关类型的对话
- **重要性排序**: 优先显示高价值内容
- **使用统计**: 了解引用的实际价值

### 🤝 团队协作
- **标准格式**: 统一的引用标准便于分享
- **知识库**: 项目知识的系统化管理
- **经验传承**: 结构化的知识积累和传递

---

🎉 **升级完成！** 现在你的每个引用都包含完整的来源信息，让知识管理更加精确和高效！ 